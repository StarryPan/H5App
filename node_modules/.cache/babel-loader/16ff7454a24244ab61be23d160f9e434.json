{"ast":null,"code":"import \"antd-mobile/es/toast/style\";\nimport _Toast from \"antd-mobile/es/toast\";\nvar _jsxFileName = \"/usr/local/var/www/orangeweb/src/pages/shop/my.js\";\n/**\n * @createdAt 2021-01-17\n * @file 排行榜\n */\nimport React from 'react';\nimport './style.less';\nimport API from '../../service/shopApi';\nimport { postFetch, getFetch } from '../../service/request';\nimport HeaderView from '../../components/HeaderView';\nimport { openURL } from '../../common/bridge';\nexport default class ShopMy extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hasShowHyy: false,\n      activeTab: 1,\n      loading: true,\n      tabs: [{\n        id: 1,\n        name: '头像框'\n      }, {\n        id: 2,\n        name: '进场特效'\n      }, {\n        id: 3,\n        name: '飘窗特效'\n      }, {\n        id: 4,\n        name: '称号'\n      }],\n      friend: null,\n      dataList: []\n    };\n  }\n  componentDidMount() {\n    this.getData();\n  }\n  async getData(type) {\n    const getRes = await getFetch(API.getItems);\n    if (!getRes) {\n      this.setState({\n        dataList: []\n      });\n    } else {\n      this.setState({\n        dataList: getRes.map(item => ({\n          id: item.id,\n          name: item.name,\n          icon: item.icon,\n          type: item.type,\n          isgive: item.is_give,\n          cost: item.cost,\n          tag: item.tag,\n          status: item.status,\n          expday: item.expiration_time\n        })),\n        loading: false\n      });\n    }\n  }\n  changeTab(type) {\n    this.setState({\n      activeTab: type\n    }, () => {\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n      });\n      this.getData(this.state.activeTab);\n    });\n  }\n  async useItem(id) {\n    _Toast.loading();\n    try {\n      const useRes = await postFetch(API.useItem, {\n        id\n      });\n      _Toast.hide();\n      _Toast.show('操作成功');\n      this.getData();\n    } catch (e) {\n      _Toast.hide();\n      _Toast.show(e.message);\n    }\n  }\n  gotoRecord() {\n    // const domain = `${window.location.protocol}://${window.location.host}`\n    // openURL(`${domain}/#/shop/my?isHideT=1`)\n    window.document.location.href = \"/#/shop/record?isHideT=1\";\n  }\n  render() {\n    const {\n      activeTab,\n      tabs,\n      dataList,\n      loading\n    } = this.state;\n    const showData = dataList.filter(item => item.type === activeTab);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"shop-index\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(HeaderView, {\n      hideBack: true,\n      title: \"道具\",\n      fixed: true,\n      rightContent: {\n        title: '购买记录',\n        onClick: () => {\n          this.gotoRecord();\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"shop-menu\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    }, tabs.map(item => {\n      return /*#__PURE__*/React.createElement(\"span\", {\n        key: item.id,\n        onClick: () => this.changeTab(item.id),\n        className: activeTab === item.id ? 'active' : '',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }\n      }, item.name);\n    })), /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }, showData.map(item => {\n      return /*#__PURE__*/React.createElement(\"li\", {\n        className: \"shop-item v2\",\n        key: item.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: `in t${item.status}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"img\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: item.icon,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }\n      }, item.name), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"ex\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }\n      }, item.expday)), item.status === 0 ? /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: () => this.useItem(item.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }\n      }, \"\\u4F7F\\u7528\") : /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: () => this.useItem(item.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }\n      }, \"\\u53D6\\u6D88\\u4F7F\\u7528\"));\n    }), !showData.length && !loading && /*#__PURE__*/React.createElement(\"li\", {\n      className: \"shop-empty\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 17\n      }\n    }, \"\\u6682\\u65E0\\u76F8\\u5173\\u9053\\u5177\")))));\n  }\n}","map":{"version":3,"names":["React","API","postFetch","getFetch","HeaderView","openURL","ShopMy","Component","constructor","props","state","hasShowHyy","activeTab","loading","tabs","id","name","friend","dataList","componentDidMount","getData","type","getRes","getItems","setState","map","item","icon","isgive","is_give","cost","tag","status","expday","expiration_time","changeTab","window","scrollTo","top","behavior","useItem","useRes","hide","show","e","message","gotoRecord","document","location","href","render","showData","filter","title","onClick","length"],"sources":["/usr/local/var/www/orangeweb/src/pages/shop/my.js"],"sourcesContent":["/**\n * @createdAt 2021-01-17\n * @file 排行榜\n */\nimport React from 'react'\nimport './style.less'\n\nimport API from '../../service/shopApi';\nimport { postFetch, getFetch } from '../../service/request'\nimport { Toast } from 'antd-mobile'\nimport HeaderView from '../../components/HeaderView'\nimport { openURL } from '../../common/bridge'\nexport default class ShopMy extends React.Component{\n  constructor(props){\n    super(props);\n    this.state = {\n      hasShowHyy: false,\n      activeTab: 1,\n      loading: true,\n      tabs: [{\n        id: 1,\n        name: '头像框',\n      },{\n        id: 2,\n        name: '进场特效',\n      },{\n        id: 3,\n        name: '飘窗特效',\n      },{\n        id: 4,\n        name: '称号',\n      }],\n      friend: null,\n      dataList: [],\n    }\n  }\n  componentDidMount(){\n    this.getData()\n  }\n  async getData(type) {\n    const getRes = await getFetch(API.getItems)\n    if (!getRes) {\n      this.setState({\n        dataList: []\n      })\n    } else  {\n      this.setState({\n        dataList: getRes.map((item) => ({\n          id: item.id,\n          name: item.name,\n          icon: item.icon,\n          type: item.type,\n          isgive: item.is_give,\n          cost: item.cost,\n          tag: item.tag,\n          status: item.status,\n          expday: item.expiration_time\n        })),\n        loading: false,\n      })\n    }\n  }\n  changeTab(type) {\n    this.setState({\n      activeTab: type,\n    }, () => {\n      window.scrollTo({\n        top: 0,\n        behavior: 'smooth',\n      })\n      this.getData(this.state.activeTab)\n    })\n  }\n  async useItem(id) {\n    Toast.loading()\n    try {\n      const useRes = await postFetch(API.useItem, {\n        id,\n      })\n      Toast.hide()\n      Toast.show('操作成功')\n      this.getData()\n    } catch (e) {\n      Toast.hide()\n      Toast.show(e.message)\n    }\n  }\n  gotoRecord() {\n    // const domain = `${window.location.protocol}://${window.location.host}`\n    // openURL(`${domain}/#/shop/my?isHideT=1`)\n    window.document.location.href = \"/#/shop/record?isHideT=1\"\n  }\n  render(){\n  const { activeTab, tabs, dataList, loading } = this.state\n  const showData = dataList.filter((item) => item.type === activeTab)\n    return (\n      <div className='shop-index'>\n        <HeaderView\n          hideBack={true}\n          title={\"道具\"}\n          fixed\n          rightContent = {{\n            title: '购买记录',\n            onClick: () => {\n              this.gotoRecord()\n            }\n          }}\n        />\n        <div className='inner'>\n          <div className='shop-menu'>\n            {tabs.map((item) => {\n              return (\n                <span key={item.id} onClick={ () => this.changeTab(item.id) } className={activeTab === item.id ? 'active' : ''}>{item.name}</span>\n              )\n            })}\n          </div>\n          <ul className='content'>\n            { showData.map((item) => {\n              return (  \n                <li className='shop-item v2' key={item.id}>\n                  <div className={`in t${item.status}`}>\n                    <div className='img'>\n                      <img src={item.icon} />\n                    </div>\n                    <p>{item.name}</p>\n                    <p className='ex'>{item.expday}</p>\n                  </div>\n                  {item.status === 0 ? (\n                    <button className='btn' onClick={() => this.useItem(item.id)}>使用</button>\n                  ) : (\n                    <button className='btn' onClick={() => this.useItem(item.id)}>取消使用</button>\n                  )}\n                </li> \n              )\n            }) }\n            { !showData.length && !loading && (\n              <li className='shop-empty'>\n                <div className='bg'></div>\n                <p>暂无相关道具</p>\n              </li>\n            ) }\n          </ul>\n        </div>\n      </div>\n    )\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}